# 2025 TODO

## 待办池

### AgentDriver

- [ ] 排查教育场景模型异常中断问题
- [ ] 绘制教育整体数据分析和自动优化
- [ ] 场景、场景集的配置上线七彩石 feat-scene-rainbow
    - [ ] 支持可视化配置（所有可配置项的可视化，场景现有的所有配置字段）
    - [ ] 支持灰度测试、批量测试、批量对比(场景、模型或者任何一个配置做 AB)测试
- [ ] 整体数据采集、分析、优化方案
- [ ] 调研 OpenDevin CodeAct1.0 和 KimiCLI（支持 ACP）
- [ ] 添加对话轨迹的上报
- [ ] 编写一个单测用来测试每次 qwen 更新之后是否能正常运行
- [ ] 七彩石支持灰度模型和灰度场景
- [ ] 可以导出所有对话轨迹生成 csv，加一个预期回答一个人工分数（百分制）
- [ ] zhiwei 上支持展示总耗时、分步耗时、总 token 消耗、分步 token 消耗
- [ ] zhiwei 上新增 Driver 一级标题
    - [ ] 数据看板
    - [ ] 场景及场景集配置可视化（七彩石是否支持灰度？）
    - [ ] Driver 体验
    - [ ] 记忆系统
- [ ] 升级 qwen-code，升级之后的事项（本质是 qwen-code 的快速迭代，正在逐步摆脱 geminiCli 的影子，所以有大量更改）
    - [ ] 看看有没有办法避免每次更新之后的修改
- [ ] 任务失败容器也要退出
- [ ] 上下文管理增强
    - 关键信息提取（决策、约束、偏好）
    - 跨会话记忆（用户 A 的历史项目）
- [ ] 调研基于 DYCODE 和 COTER，在保证上下文质量的前提下，极限有效上下文能达到千万量级
- [ ] 支持云开发的智能创建
- [ ] 工具支持 tailwind 编译，Driver 先跑批量验证，验证 tailwind 的可行性
- [ ] 支持用迭代新的样式美化方案，可以废弃组件方案 tailwind
- [ ] 场景配置上七彩石
- [ ] 工具提供 tools 完成完整的编译检查
- [ ] 场景切换后的 userContext 注入存在问题，历史上下文处理
- [ ] 需要支持一个更牛逼的上下文管理，现在就是很粗糙的把背景塞入对话中
- [ ] Agents.md 读取（优先级不高，现在还不做二次开发场景）
- [ ] 优化场景切换时的信息传递问题
    - [ ] 场景切换，历史上下文总结问题
- [ ] 工具接入对话组件，上线智能创建
- [ ] 完成一些样式美化的工作
    - [ ] 协同设计和后端进行具体规范产出

### AgentRL

- [ ] 解决超时时间异常的问题

### build-server

- [ ] build-server 监控上报

### 多端

（暂无未完成任务）

### 工具

- [ ] 游客号创建小程序、小游戏报错，编译失败
- [ ] 工具服务端口支持 MCP
- [ ] 接入 d.ts 进行 js 文件校验
- [ ] 梳理工具 MCP 可提供能力，比如上传，列个表
- [ ] 接入可视化编辑器，可以通过点选提取 Context

### zhiwei

（暂无未完成任务）

### 教育场景

- [ ] 教育并发优化
    - [ ] 编写实验任务测量并发和效率的平衡
    - [ ] 模型侧：大参数模型换小参数模型
        - [ ] 大场景 qwen3coder 换更小参数模型保证效果
            - [ ] 存在样式问题需要修复
            - [ ] 需要压测一下单实例的 TPM，设计一个压测任务
        - [ ] 替换 hunyuan-400b 需要要一下 TPM - 1w3
        - [ ] qwen3-4b 或 30b 模型后训练修复指令遵循问题
    - [ ] 非必要场景，切换类似 qwen3-4B 模型
    - [ ] infra 优化
        - [ ] token cache，跨会话 token cache
        - [ ] PD 分离


### 其他

- [ ] 云开发支持本地运行
- [ ] qwen-code memory 机制

### MyTodoList
- [ ] markdown 编辑删除下载
- [ ] todo 删除修改
- [ ] 时间块删除
- [x] 用户登录，按账号隔离资源
- [x] 进入看到示例 TODO 页面，登录后进入指定用户的工作空间
---

## 11月27日 - 12月3日

- [x] 绩效自评
- [x] AgentDriver
    - [x] 针对 MiniMax M2 的并发数据测试，得到并发测试总结
- [x] 编写教育自由创作并发能力优化分析
    - 从场景拆分、模型替换、实例扩容（资源不变）三个维度阐述
- [x] AgentRL
    - [x] 去掉错误重试
    - [x] 增加 10 分钟请求超时的限制
- [x] 教育场景
    - [x] 教育 prompt 调整


---

## 11月20日 - 11月26日

- [x] AgentRL
    - [x] 修复非流式情况下 toolcall 没有被正常处理的问题（指令遵循问题，一直重复错误的 toolcall）
    - [x] 关闭模型确认的 Loop 循环，设置 10 分钟容器自动退出
- [x] 教育并发优化
    - [x] 支持交错思维链，尝试 minimax m2（根据 haotian 提供的数据，相同显卡的情况下并发可提升六倍，需要保证效果）
        - [x] 批量任务看下效果，编译通过率 88.8 样式也还不错
- [x] AgentDriver
    - [x] 教育
        - [x] 修复教育场景日志聚合失败问题
        - [x] 修复教育场景每次发送两条消息的问题

---

## 11月13日 - 11月19日

- [x] 多端 chooseMedia 全链路加日志，辅助用户排查 ios13 问题
- [x] 准备 AI 面试题
- [x] 发布 KM 文章
- [x] 工具
    - [x] 解决 skyline 模式 devtools wxss 颜色反勾选失效问题
- [x] AgentRL
    - [x] 关闭智能诊断 → 智能诊断和 compress 指定其他模型
    - [x] 支持通过参数控制失败重试次数和是否失败重试
    - [x] 支持非 stream 模式 agent-rl
- [x] AgentDriver
    - [x] logs 塞入.devtools 中
    - [x] 场景、场景集的配置上线七彩石 feat-scene-rainbow
        - [x] 数据迁移
        - [x] 本地数据兜底
        - [x] 加密七彩石密钥
    - [x] 拆分 userConfirm（场景切换需要用户确认） 和 yolo（中间过程需要用户参与）

---

## 11月6日 - 11月12日

- [x] AgentDriver
    - [x] 支持文生图 tool，支持 toolcall 的时候自动获取 ctx 中的内容
    - [x] 支持设计师的新版样式美化方案，并进行验证
    - [x] 需求澄清 Prompt 更新
    - [x] 修复 npm i 之后 qwen 的报错问题，依赖版本不一致导致的
    - [x] 升级 qwen-code，升级之后的事项（本质是 qwen-code 的快速迭代，正在逐步摆脱 geminiCli 的影子，所以有大量更改）
        - [x] 模型配置信息好像可以写入到 setting.json 里了
        - [x] system.md 的配置方式也变了
        - [x] 日志失效
    - [x] 修复 qwen 运行时不同实例的问题，统计 Token 消耗以及每次请求的时间，比对 Driver 和裸模型的 token 消耗和耗时
    - [x] 解决 WCC crash 问题，在子进程中执行 wcc wcsc，crash 就重试

---

## 10月30日 - 11月5日

- [x] build-server
    - [x] 支持 getAppConfig Task
- [x] 多端
    - [x] 再优化一遍蓝牙和日历相关模块
    - [x] 修复 ios13.x 无法使用 chooseMedia 的问题
- [x] zhiwei
    - [x] Driver 接入 zhiwei 支持单独调用
    - [x] waitingForUserConfirm 时提供确认、取消、发送建议按钮，点击模拟消息发送
    - [x] 默认选择最新镜像
    - [x] 场景名加一下描述
- [x] 场景 TODO
    - [x] 教育场景
        - [x] 自由创作智能创建
        - [x] 自由创作二次修改
        - [x] 讲解知识
        - [x] 回答问题
        - [x] 讨论方案
        - [x] 教我写代码
        - [x] 帮我写代码
- [x] AgentDriver
    - [x] 支持分场景使用不同的模型
    - [x] 支持静态资源映射复制
    - [x] 支持场景完成后会话不失效，可继续持续对话
    - [x] 新增标识用来标志完成了项目的智能创建
    - [x] 支持自动启动容器运行任务，支持 zhiwei 上批量运行验证
    - [x] 优化场景切换逻辑，赞同、拒绝、中性
    - [x] 统一场景优化方法论 [教育场景并发提升](https://doc.weixin.qq.com/doc/w3_AQAASwanAHgCNBNBJQFEITSejDqRf?scode=AJEAIQdfAAorU45gkaAQAASwanAHg)
    - [x] 所有 .qwen 标识都替换成 .devtools

---

## 10月23日 - 10月29日

- [x] AgentDriver
    - [x] 支持传入参数设置 max_token
    - [x] 培训教育产品如何配置场景
    - [x] 上线 zhiwei

---

## 10月16日 - 10月22日

- [x] build-server 优化最大耗时环节 OT
    - [x] 优化 ot 请求，合并 exist stat readFile
- [x] AgentDriver
    - [x] 跑通 GLM4.6
    - [x] 跑通 deepseek3.2 并做简单横评
    - [x] 跑通 MiniMax M2
    - [x] 支持运行时将一些数据注入场景中供Handlebars获取，添加了一个集中式的运行时加载器注册表并扫描可用图片文件注入到 userContext 中
    - [x] 系统在开始会话后锁定工作区，避免工作区切换导致上下文异常问题
    - [x] 动态替换虚拟 workspace 文件到真正的 workspace 中（.qwen 强制覆盖，其他文件重复跳过）
    - [x] 根据场景配置动态注入静态资源
    - [x] 修复场景没有执行完成 LLM 异常返回的问题，设置 limit 4，driver 发送继续执行任务，4 次后返回 waitingForUserInput = true
    - [x] 修改 .qwen-workspace-ready
    - [x] 支持接口传入模型请求地址
    - [x] 支持打包成镜像部署到 zhiwei 上
    - [x] 需求澄清携带具体的页面图片
    - [x] get_template_list 和 code 这两天 tool 感觉也可以去掉了，然后优化整体 prompt
    - [x] 替换 scene.json 换成一个更方便看的格式
    - [x] 提供 icon 库
    - [x] 修复日志写入,新增模型配置，测试 GLM4.6 考虑要不要全部迁移
    - [x] 使用 TDesign 组件到最终代码生成中
        - [x] 使用 deepseek3.1
        - [x] 直接把工具 npm build 之后的产物放进去
        - [x] 提供一份 spec 用来说明组件如何使用
    - [x] 接入 codex/claude-code调研

---

## 10月9日 - 10月15日

- [x] AgentDriver
    - [x] 修复构建问题和打包后运行问题，上线
    - [x] scene 场景的所有配置都支持Handlebars语法
    - [x] 支持传入 handlers 参数用来获取 qwen 内部执行信息
    - [x] 支持传入 chatHistory 作为前置的对话
    - [x] 支持 userContext 替换
    - [x] 优化单一场景持续对话的信息传递问题
        - [x] 首次对话应该将说明性 prompt 信息编辑进userContext 里而不是拼接在用户输入前
    - [x] 支持隐藏 .qwen 下的内容
        - [x] system.md 支持传入 systemMdPath
        - [x] log 默认使用 process.cwd()/logs/openai. 作为写入地址, 改 openailogger 中的 logdir 支持 set

---

## 10月2日 - 10月8日

- [x] build-server 支持主包编译
    - [x] 完成完整 pageframe 联调
        - [x] 全量同步改异步
        - [x] 引入 wcc
    - [x] 新缓存
        - [x] 写入和读取缓存的时候携带 project_id
        - [x] 接入工具的缓存清理逻辑，在编译任务开始前获取文件更新，然后清除对应缓存（所以编译完要缓存一份当前全量的文件 mtime 用作对比）
- [x] 聊天工具获取成员信息无法正常展示昵称和头像
- [x] 修复 ios 构建 CFBundleURLSchemes 结构问题
- [x] 修复 revokePrivacy 无效问题
- [x] agentDriver
    - [x] qwen hardcode 迁出，并升级至最新版本
    - [x] 拆分 qwen-code GUI 与逻辑层：自研 qwen/AgentRuntime，绕开 CLI，直接以编程方式装载 qwen-code 配置、MCP 扩展、鉴权与流式回调，对外暴露 initialize / sendPrompt / registerTool / dispose，彻底把 GUI 运行时替换为可嵌入的 Runtime。
    - [x] 场景配置：完成整个场景和场景集合的架构，将场景拆分为 人设 目标 知识 可用工具 yolo 对话轨迹 输出形式，场景集合为场景的数组形式串联
    - [x] 会话化 Driver：实现内存 Session（含超时回收）、逐场景状态管理、动态环境注入，并在响应体携带 sessionId / waitingForUserInput / currentSceneId / isCompleted 等字段，实现了场景切换下驱动AgentRuntime对旧 agent 进行动态卸载和载入新场景信息及旧场景结果，以及在不同的配置下与用户进行不同交互
    - [x] 多轮对话场景串联机制：针对 yolo: false 场景停留在当前节点，等待用户补充输入，完成任务后将 Prompt 结果通过工具写回最终稿后自动推进到下一场景；返回状态明确提示是否继续输入； yolo: true 时自动完成当前场景任务并进行场景切换。当前场景是否结束由 Agent 进行判断，当 Agent 完成当前场景的任务目标后会将结果进行写入
    - [x] YOLO 模式联动：场景配置的 yolo 标记映射到 agent 的 yolo 模式
    - [x] Prompt 结果工具标准化：抽出 record_prompt_result 通用实现（tools/promptResultTool.ts），由 Adapter 统一注册，Driver 能识别工具输出并封装在会话中
    - [x] Prompt 构造增强：buildScenePrompt 在每轮调用前组合场景静态 userContext、动态背景（上一场 Prompt/背景产出）、格式约束（默认 Markdown 输出），并根据 yolo 写入用户参与提示
    - [x] http 接口：POST /send 支持 sessionId 续会、sceneGroupId 首次必填，日志/参数校验完善；返回结果包含完整会话快照，便于前端渲染。
    - [x] 支持直接函数注册 Tools 不通过 MCP HTTP 的方式
    - [x] 场景接入 Handlebars
    - [x] 支持 excludeTools
    - [x] WriteFile 迁出
    - [x] 项目支持 PM2 启动，发布上线 p6n
    - [x] 分别跑通三个场景
        - [x] 需求澄清
        - [x] 样式美化
        - [x] 项目创建
    - [x] 串联跑通完整场景集合
    - [x] 根据允许使用的 Tools 列表自动补充相关的使用示例
    - [x] 优化 toolcall 报错提醒，找到一直传参错误的原因
        - [x] 修复 todo_write 一直错误的问题，原因是模型返回了一个 object-like 的东西，通过方法修复成 object
        - [x] 对话轨迹里每次的 tools 只有 1 2 个，要找下原因
        - 在 QwenAgent.ensureInitialized 和 initialize 里，在完成工具过滤后增加一次 syncToolsWithGeminiClient() 调用，确保 Gemini 会话立即刷新所有声明的工具（包括主题工具和 record_prompt_result），避免只携带默认 todo_write（server/driver/agent/qwen/agent.ts:202, server/driver/agent/qwen/agent.ts:244）。
        - 新增私有方法 syncToolsWithGeminiClient，通过 GeminiClient.setTools() 重建工具列表，并在失败时记录警告，防止同步异常悄无声息（server/driver/agent/qwen/agent.ts:430）。
    - [x] 优化单一场景持续对话的信息传递问题
        - [x] 首次对话后的多次对话仍拼接了冗余 prompt 信息
    - [x] 优化场景切换时的信息传递问题
        - [x] 处理场景异常回复情况，isCompleted 和 waitingForUserInput同时为 false
    - [x] 数据上报对话轨迹
        - [x] 只上报最终的对话轨迹
        - [x] 通过 sessionId 解决并发对话轨迹问题

            ALS 一旦丢上下文，我们现在的兜底确实还能把当前运行期间"新增"的 openai-*.json 并入最终文件，但它是靠"执行前后日志目录的差集"判断哪些 JSON 属于这次调用。多会话并发时，如果另一条请求恰好在我们记录 baseline 之后、落差集之前写入同一个目录，那份日志也会被我错认成当前会话的增量并清掉，等对方要聚合时就找不到了。也就是说：当 ALS 不可靠时，硬差集这种方式没办法彻底解决并发问题，最多只能在单线程或负载较轻时凑合用。

            想完全消除风险，需要能在日志里识别它属于哪个 session（例如让 openaiLogger 原生写入自定义 sessionId、或者我们能提前改写文件名），或者换成一个不依赖 ALS 的安全 Hook。在"不改 qwen-code"前提下，这块还没有根本方案。

    - [x] 支持通过 sessionId 来决定不同的工作空间，以及支持传入参数确定工作空间（本地）
    - [x] 支持不通过 MCP 连接，直接继承写好的基类拉取 MCP 的 tool 把 tool 注册进去

---

## 9月25日 - 10月1日

- [x] 批量跑出一些需求澄清的结果用于给产品分析
- [x] 发布一个 npm 包用来给产品体验需求澄清 @tencent/devtools-agent
- [x] build-server 支持主包编译
    - [x] pageframe 迁移完成
    - [x] 跑通新进程调度，mock 请求到 pageframe
    - [x] pageframe addSubTask 到 baseFileCompile 最终完成任务返回
- [x] 需求澄清
    - [x] 支持脚本批量生成需求澄清
- [x] 完成一些样式美化的工作
    - [x] 编写一个 agent 专门用来处理样式美化
    - [x] 编写 Tools 来获取下面的信息
    - [x] 以主题色为基础的样式主题描述
        - [x] 基准描述
        - [x] 腾讯蓝（TDesign）
        - [x] 节日红
    - [x] 以布局为基础的样式布局描述
        - [x] 腾讯小程序布局（TDesign）
        - [x] 现代工具类布局
    - [x] 验证效果并对比
    - [x] 定义一套 DesignToken 标准，用于给 layout 使用以及强制 color 必须定义

---

## 9月18日 - 9月24日

- [x] Qwen SystemPrompt 动态替换工具
- [x] 完整智能创建 v1
    - [x] 编写开发者工具通用需求澄清场景
- [x] build-server 分享

---

## 9月11日 - 9月17日

- [x] 定义场景和场景集合的数据结构，定义场景信息如何在 Driver 中流转
- [x] OKR 填写
- [x] 敬满调查填写
- [x] 工具值班
    - [x] 登录扫码后没反应，排查出来应该是用户办公网存在问题拦截了工具请求
    - [x] 工具项目打开后无法点击，工具现在的布局有问题，在通用设置中关闭加载编辑器，调试器也没有加载，但是调试器的蒙层出现了，导致再打开编辑器仍然无法点击
    - [x] 工具无法正常编译 - nightly 上被我修过了，就是 manifest.json 的问题
- [x] build-server 架构重新设计
    - [x] 设计方案
    - [x] 改造进程管理
    - [x] 改造 task 链路
        - [x] FileTask
        - [x] Task
        - [x] addSubTask
- [x] AgentDriver 仓库项目创建和初始化架构

---

## 9月4日 - 9月10日

- [x] 支持 js 校验
- [x] 修复 wcc 在镜像中随机出现异常退出问题(我们的 wcc addon 的 gyp 配置中使用了 -Oz 的大小优化方案过于激进，在 linux 中错误优化了内存分配代码，导致在较大的 wxml 编译时内存分配错误。在 linux 中降级为使用-O1 进行优化，-O2 都有问题)后续放进 build-server 里在子进程编
- [x] 修复工具服务端口无法正常使用
- [x] 对齐 Agent Driver 的思路，完成初版架构设计
- [x] 对齐劫持 codebuddy 对话轨迹方案
- [x] 完成 agentDriver 不忘初心项目初始化，使用 node22 + tsx + tsup 替换项目原有基建并修改 tsconfig
- [x] 跑通 webide 构建报错自动修复流程
- [x] Windows，Skyline 路由，多次跳转后，跳 Skyline 会 Crash

---

## 8月28日 - 9月3日

- [x] 文件生成都在当前文件夹下，不创建新文件夹
- [x] 多端下载音频文件播放二倍速设置问题
- [x] iOS 卡顿问题反馈
- [x] 调用 OpenAI 接口时存储对应信息、对话轨迹
- [x] 支持杨涛 Agent 接入评测
- [x] 接入 Build-Server 支持小程序 TS、Less、SCSS 项目编写及单文件校验！！！
    - [x] wxml
    - [x] wxss
    - [x] json 格式校验
    - [x] 支持 wcc 在 linux 上构建

---

## 8月27日

- [x] Agent 调研 Qwen-Code、Plandex、GPT-Engineer
- [x] 设计规范初版已经产出，还需要优化一下
- [x] 接入智勇的平台，规模化验证 MCP 效果
- [x] 优化 Qwen-Code Prompt，改造成中文以及接入杨涛的 Prompt
- [x] 解决生成出来项目结构缺失问题，直接 MCP 给个模板出来
