# MiniMax M2 230B FP8 压测报告

> 生成时间: 2025/12/4 15:14:57

---

## 执行摘要

### 核心结论

| 指标 | 结果 |
|------|------|
| **最大吞吐** | 1,287 QPM @ 1024 并发 |
| **推荐生产并发** | 128-256 |
| **服务稳定性** | 1024 并发 0% 错误率 |
| **性能拐点** | 512 并发（QPM 增长放缓，延迟翻倍）|

### 生产环境建议

| 场景 | 推荐并发 | QPM | TTFT-P95 | 延迟-P95 |
|------|---------|-----|----------|----------|
| **低延迟优先** | 64 | 277 | 13s | 14s |
| **均衡配置** | 128 | 393 | 15s | 17s |
| **吞吐优先** | 256 | 721 | 20s | 21s |
| **极限吞吐** | 512+ | 778+ | 38s+ | 39s+ |

### 关键发现

1. **服务能力强**：1024 并发仍无错误，未触发 OOM
2. **瓶颈在 512 并发**：256→512 QPM 仅增长 8%，但延迟翻倍
3. **长文本影响大**：2048 token 输出时延迟达 62s
4. **FP8 优势明显**：大显存余量支撑高并发

---

## 1. 测试环境

| 项目 | 配置 |
|------|------|
| 目标服务 | `http://9.134.238.254:5050/service/16643/v1` |
| 模型 | `wxa_minimax_m2_edu` |
| 硬件配置 | 8 x NVIDIA H20 (96GB) |
| 模型精度 | FP8 |
| 模型大小 | ~230GB |
| 可用 KV Cache | ~538GB |

## 2. 测试场景概览

| 场景 | 并发 | 请求数 | MaxTokens | 说明 |
|------|------|--------|-----------|------|
| 1. 基准测试 | 1 | 5 | 512 | 单并发 baseline |
| 2. 中并发 | 32 | 64 | 512 | 32 并发热身 |
| 3. 高并发 | 64 | 128 | 512 | 64 并发 |
| 4. 超高并发 | 128 | 256 | 512 | 128 并发（上轮无压力） |
| 5. 极限并发 256 | 256 | 512 | 512 | 256 并发压力测试 |
| 6. 极限并发 512 | 512 | 512 | 512 | 512 并发，探测真正上限 |
| 7. 极端并发 1024 | 1024 | 1024 | 256 | 1024 并发，故意超载 |
| 8. 长文本极限 | 128 | 256 | 2048 | 128 并发 + 2048 token |

## 3. 详细测试结果

### 1. 基准测试 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (5/5) |
| **QPM** | 10.21 |
| **TPM** | 24,462.21 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 5.88s | 5.87s | 6.25s | 6.25s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 0ms | 0ms | 0ms |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 0 | ∞ | -∞ |

---

### 2. 中并发 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (64/64) |
| **QPM** | 150.89 |
| **TPM** | 373,356.12 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 10.73s | 10.66s | 11.02s | 14.94s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 8.05s | 7.96s | 10.47s |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 98.5 | 88.22 | 110.54 |

---

### 3. 高并发 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (128/128) |
| **QPM** | 277.56 |
| **TPM** | 719,757.14 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 13.73s | 13.72s | 13.86s | 13.98s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 9.38s | 8.71s | 13.26s |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 72.71 | 43.06 | 85 |

---

### 4. 超高并发 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (256/256) |
| **QPM** | 393.23 |
| **TPM** | 988,355.65 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 16.19s | 16.14s | 16.68s | 16.70s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 10.54s | 11.03s | 15.30s |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 63.5 | 26.51 | 169.65 |

---

### 5. 极限并发 256 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (512/512) |
| **QPM** | 721.43 |
| **TPM** | 1,824,335.63 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 20.55s | 20.55s | 20.91s | 21.00s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 12.88s | 12.36s | 19.79s |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 47.71 | 26.35 | 59.24 |

---

### 6. 极限并发 512 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (512/512) |
| **QPM** | 778.23 |
| **TPM** | 1,964,736.28 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 29.92s | 20.98s | 39.28s | 39.31s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 21.23s | 16.96s | 37.88s |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 48.17 | 23.77 | 56.56 |

---

### 7. 极端并发 1024 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (1024/1024) |
| **QPM** | 1,287.56 |
| **TPM** | 29,703.26 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 22.43s | 26.49s | 34.80s | 34.85s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 22.16s | 24.10s | 34.29s |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 39.24 | 26.67 | 61.15 |

---

### 8. 长文本极限 ✅

| 指标 | 值 |
|------|-----|
| **成功率** | 100.0% (256/256) |
| **QPM** | 122.27 |
| **TPM** | 435,417.44 |

**延迟分布 (E2E)**

| Avg | P50 | P95 | P99 |
|-----|-----|-----|-----|
| 62.67s | 62.65s | 62.76s | 62.89s |

**首 Token 延迟 (TTFT)**

| Avg | P50 | P95 |
|-----|-----|-----|
| 27.11s | 26.31s | 49.01s |

**生成速度 (TPS)**

| Avg | Min | Max |
|-----|-----|-----|
| 56.23 | 29.13 | 72.3 |

---

## 4. 性能汇总对比

| 场景 | 并发 | 成功率 | QPM | TPM | TTFT-P95 | 延迟-P95 | TPS-Avg |
|------|------|--------|-----|-----|----------|----------|---------|
| 1. 基准测试 | 1 | 100% | 10.21 | 24,462.21 | 0ms | 6.25s | 0 |
| 2. 中并发 | 32 | 100% | 150.89 | 373,356.12 | 10.47s | 11.02s | 98.5 |
| 3. 高并发 | 64 | 100% | 277.56 | 719,757.14 | 13.26s | 13.86s | 72.71 |
| 4. 超高并发 | 128 | 100% | 393.23 | 988,355.65 | 15.30s | 16.68s | 63.5 |
| 5. 极限并发 256 | 256 | 100% | 721.43 | 1,824,335.63 | 19.79s | 20.91s | 47.71 |
| 6. 极限并发 512 | 512 | 100% | 778.23 | 1,964,736.28 | 37.88s | 39.28s | 48.17 |
| 7. 极端并发 1024 | 1024 | 100% | 1,287.56 | 29,703.26 | 34.29s | 34.80s | 39.24 |
| 8. 长文本极限 | 128 | 100% | 122.27 | 435,417.44 | 49.01s | 62.76s | 56.23 |

## 5. 性能趋势分析

### 5.1 并发数 vs 吞吐量 (QPM)

```
C=  1 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 10.21
C= 32 |██████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 150.89
C= 64 |███████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 277.56
C=128 |███████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 393.23
C=256 |████████████████████████████░░░░░░░░░░░░░░░░░░░░░░| 721.43
C=512 |██████████████████████████████░░░░░░░░░░░░░░░░░░░░| 778.23
C=1024 |██████████████████████████████████████████████████| 1,287.56
C=128 |█████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 122.27
```

### 5.2 并发数 vs 延迟 P95

```
C=  1 |█████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 6.25s
C= 32 |█████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 11.02s
C= 64 |███████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 13.86s
C=128 |█████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 16.68s
C=256 |█████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 20.91s
C=512 |███████████████████████████████░░░░░░░░░░░░░░░░░░░| 39.28s
C=1024 |████████████████████████████░░░░░░░░░░░░░░░░░░░░░░| 34.80s
C=128 |██████████████████████████████████████████████████| 62.76s
```

### 5.3 并发数 vs 错误率

```
C=  1 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
C= 32 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
C= 64 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
C=128 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
C=256 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
C=512 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
C=1024 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
C=128 |░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░| 0.0%
```

## 6. 性能结论

### 6.1 总体统计

| 指标 | 值 |
|------|-----|
| 总请求数 | 2757 |
| 成功请求 | 2757 |
| 总体成功率 | 100.0% |
| 平均 TPS | 53.26 tokens/s |
| 测试总耗时 | 411.99s |

### 6.2 推荐配置

**最大吞吐量配置**
- 推荐并发: **1024**
- QPM: 1,287.56
- 错误率: 0.0%
- P95 延迟: 34.80s

**最低延迟配置**
- 推荐并发: **1**
- P95 延迟: 6.25s
- QPM: 10.21


## 7. 优化建议

- ⚠️ **TTFT 偏高** (P95 > 3s): 考虑启用 Speculative Decoding 或优化 Prefill 阶段
- ✅ **服务稳定**: 在测试范围内未发现明显瓶颈，可以尝试更高并发

---

*报告由 minimax-m2-stress-test.mjs 自动生成*
